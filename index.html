<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LSA Settlement Calculator</title>

<style>
*{box-sizing:border-box;}
body{
    margin:0;
    height:100vh;
    font-family:"Segoe UI", Arial, sans-serif;
    background:linear-gradient(135deg,#c7d2fe,#e0f2fe);
    display:flex;
    justify-content:center;
    align-items:center;
}
.wrapper{
    width:100%;
    max-width:1200px;
    display:flex;
    gap:25px;
}
.panel{
    flex:1;
    background:#ffffff;
    padding:30px;
    border-radius:18px;
    box-shadow:0 20px 45px rgba(0,0,0,0.15);
}
h2{
    text-align:center;
    color:#1e293b;
    margin-bottom:20px;
}
.group{margin-bottom:16px;}
label{
    font-size:14px;
    color:#475569;
    display:block;
    margin-bottom:6px;
}
input{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid #cbd5e1;
    font-size:15px;
    cursor:pointer;
}
.readonly{
    background:#f1f5f9;
    font-weight:600;
}
.summary{
    background:#f8fafc;
    padding:14px;
    border-radius:10px;
    font-size:14px;
    margin-top:10px;
}
.result{
    margin-top:14px;
    padding:14px;
    background:#f8fafc;
    border-radius:10px;
    font-weight:600;
}
.warning{
    margin-top:14px;
    padding:14px;
    background:#fff7ed;
    border-left:6px solid #f59e0b;
    border-radius:10px;
    color:#92400e;
    font-weight:700;
}
.consent-box{
    margin-top:18px;
    padding:14px;
    border-radius:12px;
    background:#f1f5f9;
    text-align:center;
}
.thumb-btn{
    font-size:34px;
    margin:0 18px;
    cursor:pointer;
}
.thumb-up.active{color:#16a34a;}
.thumb-down.active{color:#dc2626;}
</style>
</head>

<body>

<div class="wrapper">

<!-- LEFT PANEL -->
<div class="panel">
<h2>LSA & Interest</h2>

<div class="group">
<label>LSA Amount</label>
<input type="number" id="lsa" step="0.01">
</div>

<div class="group">
<label>Sale Date</label>
<input type="date" id="saleDate">
</div>

<div class="group">
<label>Total Interest</label>
<input id="interest" class="readonly" readonly>
</div>

<div class="group">
<label>LSA as on Date</label>
<input id="lsaDate" class="readonly" readonly>
</div>

<div class="summary" id="interestSummary">
Interest summary will appear here.
</div>
</div>

<!-- RIGHT PANEL -->
<div class="panel">
<h2>Waiver / Settlement</h2>

<div class="group">
<label>Enter Waiver %</label>
<input type="number" id="waiverPct" step="0.01">
</div>

<div class="group">
<label>OR Enter Settlement Amount (With Interest)</label>
<input type="number" id="settleAmt" step="0.01">
</div>

<div class="result" id="resultText">
Settlement details will appear here.
</div>

<div class="warning" id="warningText" style="display:none;"></div>

<div class="consent-box">
<span class="thumb-btn thumb-up" onclick="setConsent(true)">üëç</span>
<span class="thumb-btn thumb-down" onclick="setConsent(false)">üëé</span>
<div id="consentStatus">Customer response not recorded</div>
</div>

</div>
</div>

<script>
let totalAmount=0, lsaWithInterest=0;

/* Live recalculation */
["lsa","saleDate","waiverPct","settleAmt"].forEach(id=>{
    document.getElementById(id).addEventListener("input",recalculate);
});

function recalculate(){
    calculateInterest();
    if(waiverPct.value){
        applyWaiver();
    } else if(settleAmt.value){
        applySettlement();
    } else {
        resultText.innerHTML="Settlement details will appear here.";
        warningText.style.display="none";
    }
}

/* Interest calculation */
function calculateInterest(){
    let lsaVal = +lsa.value || 0;
    let saleDt = new Date(saleDate.value);
    if(!lsaVal || !saleDate.value) return;

    let today = new Date();
    if(saleDt > today) return;

    let months =
        (today.getFullYear() - saleDt.getFullYear()) * 12 +
        (today.getMonth() - saleDt.getMonth());

    if(today.getDate() < saleDt.getDate()) months--;
    if(months < 0) months = 0;

    let interestPerYear = lsaVal * 0.18;
    let totalInterest = interestPerYear * (months / 12);

    totalAmount = lsaVal;
    lsaWithInterest = lsaVal + totalInterest;

    interest.value = totalInterest.toFixed(2);
    lsaDate.value = lsaWithInterest.toFixed(2);

    let durationText;
    if(months < 12){
        durationText = `${months} months`;
    } else {
        let y = Math.floor(months / 12);
        let m = months % 12;
        durationText = m === 0 ? `${y} years` : `${y} years ${m} months`;
    }

    interestSummary.innerHTML = `
        <b>Interest Rate:</b> 18% p.a.<br>
        <b>Interest per Year:</b> ‚Çπ${interestPerYear.toFixed(2)}<br>
        <b>Duration:</b> ${durationText}
    `;
}

/* Waiver based */
function applyWaiver(){
    settleAmt.value="";
    let waiver = +waiverPct.value;
    if(!waiver) return;

    let recover = 100 - waiver;
    let withInt = lsaWithInterest * (recover/100);
    let withoutInt = totalAmount * (recover/100);

    resultText.innerHTML = `
        Settlement (With Interest): ‚Çπ${withInt.toFixed(2)}<br>
        Settlement (Without Interest): ‚Çπ${withoutInt.toFixed(2)}
    `;

    policyCheck(waiver);
}

/* Settlement based */
function applySettlement(){
    waiverPct.value="";
    let settle = +settleAmt.value;
    if(!settle || !lsaWithInterest) return;

    let waiver = 100 - (settle/lsaWithInterest)*100;
    let withoutInt = totalAmount * ((100-waiver)/100);

    resultText.innerHTML = `
        Calculated Waiver: ${waiver.toFixed(2)}%<br>
        Settlement (Without Interest): ‚Çπ${withoutInt.toFixed(2)}
    `;

    policyCheck(waiver);
}

/* Policy check */
function policyCheck(waiver){
    let saleYr = new Date(saleDate.value).getFullYear();
    let max = saleYr > 2020 ? 70 : 74;

    if(waiver > max){
        let allowedWith = lsaWithInterest * ((100-max)/100);
        let allowedWithout = totalAmount * ((100-max)/100);

        warningText.style.display="block";
        warningText.innerHTML = `
            ‚ö†Ô∏è Manager approval required.<br>
            Max offer (With Interest): ‚Çπ${allowedWith.toFixed(2)}<br>
            Max offer (Without Interest): ‚Çπ${allowedWithout.toFixed(2)}
        `;
    } else {
        warningText.style.display="none";
    }
}

/* Consent */
function setConsent(agreed){
    document.querySelector(".thumb-up").classList.remove("active");
    document.querySelector(".thumb-down").classList.remove("active");

    if(agreed){
        document.querySelector(".thumb-up").classList.add("active");
        consentStatus.innerHTML="Customer agreed";
        consentStatus.style.color="#16a34a";
    } else {
        document.querySelector(".thumb-down").classList.add("active");
        consentStatus.innerHTML="Customer not agreed";
        consentStatus.style.color="#dc2626";
    }
}
</script>

</body>
</html>
